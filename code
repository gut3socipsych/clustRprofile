#test dataset to produce a melted dataframe as arg in plot function 
head(mtcars) #dataset
cars_dist<-dist(mtcars, method = "euclidean") #distance measure  
cars_clust<-hclust(cars_dist) #cluster matrix 
plot(cars_clust) #denrogram to visualize number of clusters 
clust_assgn<-cutree(cars_clust, k = 3) #assign clusters based on number of clusters

cars_z<-mtcars %>% scale(., center = TRUE, scale = TRUE) #create standardized scores (z-scores)
cars_z<-tbl_df(as.data.frame(cars_z)) #reformat as local df

cars_z<-bind_cols(cars_z, as.data.frame(clust_assgn)) #create standardized df with cluster assignment df
cars_z<-tbl_df(cars_z) #reformat as local df 

cars_z_means<-cars_z %>% group_by(clust_assgn) %>% summarise_each(funs(mean(.,na.rm=TRUE))) #summarize standarized scores df
cars_melt<-melt(cars_z_means, id.vars = "clust_assgn") #reshape standardized scores df 

#plot themes 

c_theme_default<-theme_gray() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.25)
        )

#plot funtion 

clustRprofile<-function(data_melt, theme){
  profile_plot<-ggplot(data_melt, aes(x = variable, y = value, group = as.factor(clust_assgn), color = as.factor(clust_assgn))) +
    geom_path(alpha = 0.9) + geom_point() + 
    labs(x = "Variables", y = "Scaled Averages", title = "Cluster Profiles", color = "Clusters") + 
    theme
  print(profile_plot)
}
