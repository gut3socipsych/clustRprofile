test <- mtcars
test_dist <- dist(test,method = "e")
test_clust <- hclust(test_dist)
plot(test_clust)
test_assign <- cutree(test_clust, k = 3)
test_z <- scale(x = test, center = T, scale = T)
test_z <- cbind(test_z, as.matrix(test_assign)) #attach cluster assignment
test_z <- aggregate(x = test_z, by = list("V13"), FUN = mean)
test_z
colnames(test_z)
test_assign
class(test_assign)
test_z <- as.data.frame(scale(x = test, center = T, scale = T))
test_z <- cbind(test_z, as.data.frame(clust = test_assign)) #attach cluster assignment
test_z <- cbind(test_z, as.data.frame(test_assign)) #attach cluster assignment
View(test_z)
test_z <- aggregate(x = test_z, by = list("V13"), FUN = mean)
test_z <- aggregate(x = test_z, by = test_assign, FUN = mean)
test_z$test_assign
table(test_z$test_assign)
unique(test_z$test_assign)
test_z <- aggregate(x = test_z, by = list(unique(test_assign)), FUN = mean)
test_z <- aggregate(x = test_z, by = list(unique(test_z$test_assign)), FUN = mean)
list(unique(test_z$test_assign))
test_z <- aggregate(x = test_z, by = unique(test_z$test_assign), FUN = mean)
c <- unique(test_z$test_assign)
c
as.list(x)
as.list(c)
test_z <- aggregate(x = test_z, by = as.list(unique(test_z$test_assign)), FUN = mean)
c <- as.list(c)
c
class(c)
test_z <- aggregate(x = test_z, by = as.list(unique(test_z$test_assign)), FUN = mean)
test_z <- aggregate(x = test_z, by = as.list(unique(test_z$test_assign)), FUN = "mean")
aggregate.data.frame(x = test_x, by = as.list(unique(test_z$test_assign)), FUN = mean)
aggregate.data.frame(x = test_z, by = as.list(unique(test_z$test_assign)), FUN = mean)
aggregate.data.frame(x = test_z, by = test_z$test_assign, FUN = mean)
aggregate.data.frame(x = test_z, by = as.list(test_z$test_assign), FUN = mean)
aggregate(.~test_assign, data = test_z)
aggregate(.~test_assign, data = test_z, FUN = mean)
test_z <- as.data.frame(scale(x = test, center = T, scale = T))
test_z <- cbind(test_z, as.data.frame(test_assign)) #attach cluster assignment
test_z <- aggregate(.~test_assign, data = test_z, FUN = mean)
class(test_z)
View(test_z)
t(test_z)
test_melt<-melt(test_z, id.vars = "clust_assgn") #reshape standardized scores df
library(reshape2)
test_melt<-melt(test_z, id.vars = "test_assgn") #reshape standardized scores df
colnames(test_z)
test_melt<-melt(test_z, id.vars = "test_assign") #reshape standardized scores df
test_melt
test_z<-melt(test_z, id.vars = "test_assign") #reshape standardized scores df
clustRprofile(data_melt = test_z)
dir()
source("clustRprofile_function_script.R")
clustRprofile(data_melt = test_z)
clustRprofile<-function(data_melt){
require(ggplot2)
c_theme_default<-theme_gray() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.25))
profile_plot<-ggplot(data_melt, aes(x = variable, y = value, group = as.factor(clust_assign), color = as.factor(clust_assgn))) +
geom_path(alpha = 0.9) + geom_point() +
labs(x = "Variables", y = "Scaled Averages", title = "Cluster Profiles", color = "Clusters") +
c_theme_default
print(profile_plot)
}
clustRprofile(data_melt = test_z)
#WORKING NOTES....
library(reshape2)
source("clustRprofile_function_script.R")
test <- mtcars
test_dist <- dist(test,method = "e")
test_clust <- hclust(test_dist)
plot(test_clust)
clust_assgn <- cutree(test_clust, k = 3)
test_z <- as.data.frame(scale(x = test, center = T, scale = T))
test_z <- cbind(test_z, as.data.frame(clust_assgn)) #attach cluster assignment
test_z <- aggregate(.~clust_assgn, data = test_z, FUN = mean) #summarize standarized scores df
test_z<-melt(test_z, id.vars = "clust_assgn") #reshape standardized scores df
clustRprofile(data_melt = test_z)
test_fun <- function(dataset, cluster_count){
require(ggplot2);require(reshape2)
#calculate cluster groups
df_dist <- dist(dataset, method = "e")
df_clust <- hclust(df_dist)
clust_assgn <- cutree(df_clust, k = cluster_count)
df_z <- as.data.frame(scale(x = dataset, center = T, scale = T))
df_z <- cbind(df_z, as.data.frame(clust_assgn))
df_z <- aggregate(.~clust_assgn, data = df_z, FUN = mean)
df_z <- melt(df_z, id.vars = "clust_assgn")
}
test_fun(test, 3)
}
test_fun <- function(dataset, cluster_count){
require(ggplot2);require(reshape2)
#calculate cluster groups
df_dist <- dist(dataset, method = "e")
df_clust <- hclust(df_dist)
clust_assgn <- cutree(df_clust, k = cluster_count)
df_z <- as.data.frame(scale(x = dataset, center = T, scale = T))
df_z <- cbind(df_z, as.data.frame(clust_assgn))
df_z <- aggregate(.~clust_assgn, data = df_z, FUN = mean)
df_z <- melt(df_z, id.vars = "clust_assgn")
retrun(df_z)
}
a <- test_fun(test, 3)
test_fun <- function(dataset, cluster_count){
require(ggplot2);require(reshape2)
#calculate cluster groups
df_dist <- dist(dataset, method = "e")
df_clust <- hclust(df_dist)
clust_assgn <- cutree(df_clust, k = cluster_count)
df_z <- as.data.frame(scale(x = dataset, center = T, scale = T))
df_z <- cbind(df_z, as.data.frame(clust_assgn))
df_z <- aggregate(.~clust_assgn, data = df_z, FUN = mean)
df_z <- melt(df_z, id.vars = "clust_assgn")
return(df_z)
}
a <- test_fun(test, 3)
a
clustRprofile(a)
clustRprofile(a)
head(a)
test_fun <- function(dataset, cluster_count){
require(ggplot2);require(reshape2)
#calculate cluster groups
df_dist <- dist(dataset, method = "e")
df_clust <- hclust(df_dist)
clust_assgn <- cutree(df_clust, k = cluster_count)
df_z <- as.data.frame(scale(x = dataset, center = T, scale = T))
df_z <- cbind(df_z, as.data.frame(clust_assgn))
df_z <- aggregate(.~clust_assgn, data = df_z, FUN = mean)
df_z <- melt(df_z, id.vars = "clust_assgn")
#build cluster plot
profile_plot <- ggplot(data = df_z, aes(x = variable,
y = value,
group = as.factor(clust_assgn),
color = as.factor(clust_assgn))) +
geom_pat(alpha = 0.9) + geom_point() +
labs(x = "Variables", y = "Scaled Averages", title = "Cluster Profiles", color = "Clusters") +
theme_gray() + theme(axis.text.x = element_text(angle = 90, vjust = 0.25))
return(profile_plot)
}
a <- test_fun(test, 3)
}
test_fun <- function(dataset, cluster_count){
require(ggplot2);require(reshape2)
#calculate cluster groups
df_dist <- dist(dataset, method = "e")
df_clust <- hclust(df_dist)
clust_assgn <- cutree(df_clust, k = cluster_count)
df_z <- as.data.frame(scale(x = dataset, center = T, scale = T))
df_z <- cbind(df_z, as.data.frame(clust_assgn))
df_z <- aggregate(.~clust_assgn, data = df_z, FUN = mean)
df_z <- melt(df_z, id.vars = "clust_assgn")
#build cluster plot
profile_plot <- ggplot(data = df_z, aes(x = variable,
y = value,
group = as.factor(clust_assgn),
color = as.factor(clust_assgn))) +
geom_path(alpha = 0.9) + geom_point() +
labs(x = "Variables", y = "Scaled Averages", title = "Cluster Profiles", color = "Clusters") +
theme_gray() + theme(axis.text.x = element_text(angle = 90, vjust = 0.25))
return(profile_plot)
}
a <- test_fun(test, 3)
a
a
a <- test_fun(test, 4)
a
clustRprofile <- function(dataset, cluster_count){
require(ggplot2);require(reshape2)
#calculate cluster groups
df_dist <- dist(dataset, method = "e")
df_clust <- hclust(df_dist)
clust_assgn <- cutree(df_clust, k = cluster_count)
df_z <- as.data.frame(scale(x = dataset, center = T, scale = T))
df_z <- cbind(df_z, as.data.frame(clust_assgn))
df_z <- aggregate(.~clust_assgn, data = df_z, FUN = mean)
df_z <- melt(df_z, id.vars = "clust_assgn")
#build cluster plot
profile_plot <- ggplot(data = df_z, aes(x = variable,
y = value,
group = as.factor(clust_assgn),
color = as.factor(clust_assgn))) +
geom_path(alpha = 0.9) + geom_point() +
labs(x = "Variables", y = "Scaled Averages", title = "Cluster Profiles", color = "Clusters") +
theme_gray() + theme(axis.text.x = element_text(angle = 90, vjust = 0.25))
return(profile_plot)
}
clustRprofile(a)
clustRprofile <- function(dataset, cluster_count){
require(ggplot2);require(reshape2)
#calculate cluster groups
df_dist <- dist(dataset, method = "e")
df_clust <- hclust(df_dist)
clust_assgn <- cutree(df_clust, k = cluster_count)
df_z <- as.data.frame(scale(x = dataset, center = T, scale = T))
df_z <- cbind(df_z, as.data.frame(clust_assgn))
df_z <- aggregate(.~clust_assgn, data = df_z, FUN = mean)
df_z <- melt(df_z, id.vars = "clust_assgn")
#build cluster plot
profile_plot <- ggplot(data = df_z, aes(x = variable,
y = value,
group = as.factor(clust_assgn),
color = as.factor(clust_assgn))) +
geom_path(alpha = 0.9) + geom_point() +
labs(x = "Variables", y = "Scaled Averages", title = "Cluster Profiles", color = "Clusters") +
theme_gray() + theme(axis.text.x = element_text(angle = 90, vjust = 0.25))
return(profile_plot)
}
clustRprofile(test, 4)
clustRprofile(test, 5)
clustRprofile(test, 2)
